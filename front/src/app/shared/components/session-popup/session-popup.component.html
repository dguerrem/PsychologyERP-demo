<!-- Modal Backdrop -->
<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50" 
     (click)="onBackdropClick($event)">
  
  <!-- Modal Content -->
  <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto" 
       (click)="$event.stopPropagation()">
    
    <!-- Header -->
    <div class="border-b border-gray-200 p-6">
      <div class="flex items-center justify-between">
        <div>
          <h2 class="text-2xl font-bold text-gray-900">Detalles de la Sesión</h2>
          <p class="text-sm text-gray-500 mt-1">ID: #{{ session.id }}</p>
        </div>
        <button 
          (click)="onClose()"
          class="text-gray-400 hover:text-gray-600 transition-colors">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
          </svg>
        </button>
      </div>
    </div>

    <!-- Content -->
    <div class="p-6">
      
      <!-- Patient Info -->
      <div class="mb-6">
        <h3 class="text-lg font-semibold text-gray-900 mb-3">Información del Paciente</h3>
        <div class="bg-gray-50 rounded-lg p-4">
          <p class="text-lg font-medium text-gray-900">{{ getPatientName(session.patient_id) }}</p>
          <p class="text-sm text-gray-600">ID: {{ session.patient_id }}</p>
        </div>
      </div>

      <!-- Session Details -->
      <div class="mb-6">
        <h3 class="text-lg font-semibold text-gray-900 mb-3">Detalles de la Sesión</h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          
          <!-- Date and Time -->
          <div class="bg-gray-50 rounded-lg p-4">
            <h4 class="font-medium text-gray-900 mb-2">Fecha y Hora</h4>
            <p class="text-sm text-gray-600 mb-1">{{ formatDate(session.session_date) }}</p>
            <p class="text-sm text-gray-600">{{ formatTime(session.start_time) }} - {{ formatTime(session.end_time) }}</p>
          </div>

          <!-- Clinic -->
          <div class="bg-gray-50 rounded-lg p-4">
            <h4 class="font-medium text-gray-900 mb-2">Clínica</h4>
            <div class="flex items-center gap-2">
              <div [class]="getClinicConfig(session.clinic_id).backgroundColor + ' ' + getClinicConfig(session.clinic_id).borderColor" 
                   class="w-4 h-4 rounded border"></div>
              <span class="text-sm text-gray-600">{{ getClinicConfig(session.clinic_id).name }}</span>
            </div>
          </div>

          <!-- Session Type -->
          <div class="bg-gray-50 rounded-lg p-4">
            <h4 class="font-medium text-gray-900 mb-2">Tipo de Sesión</h4>
            <p class="text-sm text-gray-600">{{ session.type }}</p>
          </div>

          <!-- Mode -->
          <div class="bg-gray-50 rounded-lg p-4">
            <h4 class="font-medium text-gray-900 mb-2">Modalidad</h4>
            <div class="flex items-center gap-2">
              @if (session.mode === 'Online') {
                <svg class="w-4 h-4 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
                </svg>
              } @else {
                <svg class="w-4 h-4 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
                </svg>
              }
              <span class="text-sm text-gray-600">{{ session.mode }}</span>
            </div>
          </div>

        </div>
      </div>

      <!-- Status -->
      <div class="mb-6">
        <h3 class="text-lg font-semibold text-gray-900 mb-3">Estado</h3>
        <div class="flex items-center gap-2">
          <span [class]="getStatusBadgeClass(session.status)" 
                class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium">
            {{ getStatusText(session.status) }}
          </span>
          @if (session.status === 'completed') {
            <div class="w-2 h-2 bg-green-500 rounded-full"></div>
          }
        </div>
      </div>

      <!-- Payment Info -->
      <div class="mb-6">
        <h3 class="text-lg font-semibold text-gray-900 mb-3">Información de Pago</h3>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
          
          <!-- Price -->
          <div class="bg-gray-50 rounded-lg p-4">
            <h4 class="font-medium text-gray-900 mb-2">Precio</h4>
            <p class="text-lg font-semibold text-gray-900">{{ session.price }}€</p>
          </div>

          <!-- Payment Method -->
          <div class="bg-gray-50 rounded-lg p-4">
            <h4 class="font-medium text-gray-900 mb-2">Método de Pago</h4>
            <p class="text-sm text-gray-600">{{ getPaymentMethodText(session.payment_method) }}</p>
          </div>

          <!-- Payment Status -->
          <div class="bg-gray-50 rounded-lg p-4">
            <h4 class="font-medium text-gray-900 mb-2">Estado del Pago</h4>
            <span [class]="getPaymentStatusBadgeClass(session.payment_status)" 
                  class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium">
              {{ getPaymentStatusText(session.payment_status) }}
            </span>
          </div>

        </div>
      </div>

      <!-- Notes -->
      @if (session.notes) {
        <div class="mb-6">
          <h3 class="text-lg font-semibold text-gray-900 mb-3">Notas</h3>
          <div class="bg-gray-50 rounded-lg p-4">
            <p class="text-sm text-gray-600">{{ session.notes }}</p>
          </div>
        </div>
      }

      <!-- Timestamps -->
      <div class="mb-6">
        <h3 class="text-lg font-semibold text-gray-900 mb-3">Información de Registro</h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          
          <!-- Created At -->
          <div class="bg-gray-50 rounded-lg p-4">
            <h4 class="font-medium text-gray-900 mb-2">Creado</h4>
            <p class="text-sm text-gray-600">{{ formatDate(session.created_at) }}</p>
          </div>

          <!-- Updated At -->
          <div class="bg-gray-50 rounded-lg p-4">
            <h4 class="font-medium text-gray-900 mb-2">Actualizado</h4>
            <p class="text-sm text-gray-600">{{ formatDate(session.updated_at) }}</p>
          </div>

        </div>
      </div>

    </div>

    <!-- Footer -->
    <div class="border-t border-gray-200 p-6 bg-gray-50 rounded-b-lg">
      <div class="flex justify-end gap-3">
        <button 
          (click)="onClose()"
          class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors">
          Cerrar
        </button>
        <button class="px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors">
          Editar Sesión
        </button>
      </div>
    </div>

  </div>
</div>